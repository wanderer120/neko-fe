{"ast":null,"code":"import _regeneratorRuntime from\"/Users/wanderer120/Documents/projects/neko/neko-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/wanderer120/Documents/projects/neko/neko-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/wanderer120/Documents/projects/neko/neko-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _assertThisInitialized from\"/Users/wanderer120/Documents/projects/neko/neko-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createClass from\"/Users/wanderer120/Documents/projects/neko/neko-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/wanderer120/Documents/projects/neko/neko-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/wanderer120/Documents/projects/neko/neko-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import'bootstrap/dist/css/bootstrap.css';import React,{Component}from'react';import Web3 from'web3';import'./App.css';import{_ABI,_CONTRACT_ADDRESS}from'./config';import Button from'react-bootstrap/Button';import MainPage from'./Components/MainPage';var app;var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);_createClass(App,[{key:\"componentWillMount\",value:function componentWillMount(){this.loadBlockchainData();}},{key:\"loadBlockchainData\",value:function(){var _loadBlockchainData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var userDetailObj,accounts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(ethEnabled()){_context.next=4;break;}alert(\"Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!\");_context.next=8;break;case 4:userDetailObj={};_context.next=7;return window.web3.eth.getAccounts().then(function(accounts){if(accounts.length===0){console.log('MetaMask is locked');_this2.setState({isLogin:false});}else{_this2.setState({isLogin:true});userDetailObj.account=accounts[0];window.web3.eth.getBalance(accounts[0]).then(function(value){userDetailObj.balance=window.web3.utils.fromWei(value);_this2.setState({userDetail:userDetailObj});});userDetailObj.contract=new window.web3.eth.Contract(_ABI,_CONTRACT_ADDRESS);userDetailObj.contract.methods.isUserExists(userDetailObj.account).call().then(function(result){userDetailObj.userExist=result;_this2.setState({userExist:result});});userDetailObj.contract.methods.users(userDetailObj.account).call().then(function(result){userDetailObj.itemCount=result.itemCount;_this2.setState({itemCount:result.itemCount});});userDetailObj.contract.methods.lastItemId().call().then(function(result){_this2.setState({universeItemCount:result});});userDetailObj.contract.methods.getAllItemsByUser(userDetailObj.account).call().then(function(result){var itemObj={};itemObj.idArr=[];itemObj.powerArr=[];itemObj.lastWinArr=[];for(var i=0;i<result[Object.keys(result)[0]].length;i++){itemObj.idArr[i]=result[Object.keys(result)[0]][i];itemObj.powerArr[i]=result[Object.keys(result)[1]][i];itemObj.lastWinArr[i]=window.web3.utils.fromWei(result[Object.keys(result)[2]][i],'ether');}userDetailObj.itemIdArr=itemObj.idArr;userDetailObj.itemPowerArr=itemObj.powerArr;userDetailObj.lastWinArr=itemObj.lastWinArr;_this2.setState({userDetail:userDetailObj});});userDetailObj.contract.methods.lastItemId().call().then(function(result){if(result>8){userDetailObj.winnerArr=[];userDetailObj.winnerAmountArr=[];var _loop=function _loop(i){userDetailObj.contract.methods.allItems(i).call().then(function(result){userDetailObj.winnerArr[i]=result.owner.substring(0,6)+\"...\";userDetailObj.winnerAmountArr[i]=window.web3.utils.fromWei(result.LastWinAmount,'ether');_this2.setState({userDetail:userDetailObj});});};for(var i=0;i<8;i++){_loop(i);}}});}},function(){console.log(\"fail callback\");});case 7:accounts=_context.sent;case 8:case\"end\":return _context.stop();}}},_callee);}));function loadBlockchainData(){return _loadBlockchainData.apply(this,arguments);}return loadBlockchainData;}()}]);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);app=_assertThisInitialized(_this);_this.state={isLogin:false,userDetail:{account:-1,balance:-1,contract:{}},userExist:false,itemCount:-1,universeItemCount:-1,isW3:false};_this.LoginToMetamask=_this.LoginToMetamask.bind(_assertThisInitialized(_this));if(typeof window.ethereum!=='undefined'){_this.setState({isW3:true});}if(typeof window.ethereum!=='undefined'){window.ethereum.on('accountsChanged',function(accounts){//window.location.reload();\nif(!ethEnabled()){alert(\"Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!\");}else{var userDetailObj={};window.web3.eth.getAccounts().then(function(accounts){if(accounts.length===0){console.log('MetaMask is locked');app.setState({isLogin:false});}else{app.setState({isLogin:true});userDetailObj.account=accounts[0];window.web3.eth.getBalance(accounts[0]).then(function(value){userDetailObj.balance=window.web3.utils.fromWei(value);app.setState({userDetail:userDetailObj});});userDetailObj.contract=new window.web3.eth.Contract(_ABI,_CONTRACT_ADDRESS);userDetailObj.contract.methods.isUserExists(userDetailObj.account).call().then(function(result){userDetailObj.userExist=result;app.setState({userExist:result});});userDetailObj.contract.methods.users(userDetailObj.account).call().then(function(result){userDetailObj.itemCount=result.itemCount;app.setState({itemCount:result.itemCount});});userDetailObj.contract.methods.lastItemId().call().then(function(result){app.setState({universeItemCount:result});});userDetailObj.contract.methods.getAllItemsByUser(userDetailObj.account).call().then(function(result){var itemObj={};itemObj.idArr=[];itemObj.powerArr=[];itemObj.lastWinArr=[];for(var i=0;i<result[Object.keys(result)[0]].length;i++){itemObj.idArr[i]=result[Object.keys(result)[0]][i];itemObj.powerArr[i]=result[Object.keys(result)[1]][i];itemObj.lastWinArr[i]=window.web3.utils.fromWei(result[Object.keys(result)[2]][i],'ether');}userDetailObj.itemIdArr=itemObj.idArr;userDetailObj.itemPowerArr=itemObj.powerArr;userDetailObj.lastWinArr=itemObj.lastWinArr;app.setState({userDetail:userDetailObj});});userDetailObj.contract.methods.lastItemId().call().then(function(result){if(result>8){userDetailObj.winnerArr=[];userDetailObj.winnerAmountArr=[];var _loop2=function _loop2(i){userDetailObj.contract.methods.allItems(i).call().then(function(result){userDetailObj.winnerArr[i]=result.owner.substring(0,6)+\"...\";userDetailObj.winnerAmountArr[i]=window.web3.utils.fromWei(result.LastWinAmount,'ether');app.setState({userDetail:userDetailObj});});};for(var i=0;i<8;i++){_loop2(i);}}});}},function(){console.log(\"fail callback\");});}});}return _this;}_createClass(App,[{key:\"render\",value:function render(){if(this.state.isLogin){return/*#__PURE__*/_jsx(MainPage,{userDetail:this.state.userDetail,universeItemCount:this.state.universeItemCount});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"container\",style:{display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:this.LoginToMetamask,children:\"Connect to Metamask\"})});}}},{key:\"LoginToMetamask\",value:function LoginToMetamask(){this.loadBlockchainData();}}]);return App;}(Component);var ethEnabled=function ethEnabled(){if(window.ethereum){window.web3=new Web3(window.ethereum);window.ethereum.enable();return true;}return false;};export default App;","map":{"version":3,"sources":["/Users/wanderer120/Documents/projects/neko/neko-fe/src/App.js"],"names":["React","Component","Web3","_ABI","_CONTRACT_ADDRESS","Button","MainPage","app","App","loadBlockchainData","ethEnabled","alert","userDetailObj","window","web3","eth","getAccounts","then","accounts","length","console","log","setState","isLogin","account","getBalance","value","balance","utils","fromWei","userDetail","contract","Contract","methods","isUserExists","call","result","userExist","users","itemCount","lastItemId","universeItemCount","getAllItemsByUser","itemObj","idArr","powerArr","lastWinArr","i","Object","keys","itemIdArr","itemPowerArr","winnerArr","winnerAmountArr","allItems","owner","substring","LastWinAmount","props","state","isW3","LoginToMetamask","bind","ethereum","on","display","justifyContent","enable"],"mappings":"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","sourcesContent":["import 'bootstrap/dist/css/bootstrap.css';\nimport React, { Component } from 'react'\nimport Web3 from 'web3'\nimport './App.css'\n\nimport { _ABI, _CONTRACT_ADDRESS } from './config'\n\nimport Button from 'react-bootstrap/Button'\nimport MainPage from './Components/MainPage'\n\nvar app;\nclass App extends Component {\n  componentWillMount() {\n    this.loadBlockchainData()\n  }\n  async loadBlockchainData() {\n    if (!ethEnabled()) {\n      alert(\"Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!\");\n    }\n    else{\n      let userDetailObj = {};\n      const accounts = await window.web3.eth.getAccounts().then((accounts)=>{\n        if (accounts.length === 0) {\n          console.log('MetaMask is locked')\n          this.setState({isLogin:false})\n        }\n        else {\n          this.setState({isLogin:true})\n          userDetailObj.account = accounts[0]\n          window.web3.eth.getBalance(accounts[0]).then((value)=>{\n            userDetailObj.balance = window.web3.utils.fromWei(value)\n            this.setState({userDetail:userDetailObj})\n          });\n          userDetailObj.contract = new window.web3.eth.Contract(_ABI, _CONTRACT_ADDRESS)\n          userDetailObj.contract.methods.isUserExists(userDetailObj.account).call().then((result)=>{\n            userDetailObj.userExist = result\n            this.setState({userExist:result})\n          });\n          userDetailObj.contract.methods.users(userDetailObj.account).call().then((result)=>{\n            userDetailObj.itemCount = result.itemCount;\n            this.setState({itemCount:result.itemCount})\n          });\n          userDetailObj.contract.methods.lastItemId().call().then((result)=>{\n            this.setState({universeItemCount:(result)})\n          });\n          userDetailObj.contract.methods.getAllItemsByUser(userDetailObj.account).call().then((result)=>{\n            let itemObj = {};\n            itemObj.idArr = [];\n            itemObj.powerArr = [];\n            itemObj.lastWinArr = [];\n            for(let i=0;i<result[Object.keys(result)[0]].length;i++){\n              itemObj.idArr[i] = result[Object.keys(result)[0]][i];\n              itemObj.powerArr[i] = result[Object.keys(result)[1]][i];\n              itemObj.lastWinArr[i] = window.web3.utils.fromWei(result[Object.keys(result)[2]][i],'ether');\n            }\n            userDetailObj.itemIdArr = itemObj.idArr;\n            userDetailObj.itemPowerArr = itemObj.powerArr;\n            userDetailObj.lastWinArr = itemObj.lastWinArr;\n            this.setState({userDetail:userDetailObj});\n          });\n          userDetailObj.contract.methods.lastItemId().call().then((result)=>{\n            if(result>8){\n              userDetailObj.winnerArr = [];\n              userDetailObj.winnerAmountArr = [];\n              for(let i=0;i<8;i++){\n                userDetailObj.contract.methods.allItems(i).call().then((result)=>{\n                  userDetailObj.winnerArr[i] = result.owner.substring(0,6)+\"...\";\n                  userDetailObj.winnerAmountArr[i] = window.web3.utils.fromWei(result.LastWinAmount,'ether');\n                  this.setState({userDetail:userDetailObj});\n                });\n              }\n            }\n          });\n        }\n      },()=>{\n        console.log(\"fail callback\");\n      })\n    }\n  }\n  constructor(props) {\n    super(props)\n    app = this;\n    this.state = {\n      isLogin: false,\n      userDetail: {account:-1,balance:-1,contract:{}},\n      userExist: false,\n      itemCount:-1,\n      universeItemCount:-1,\n      isW3:false\n    }\n    this.LoginToMetamask = this.LoginToMetamask.bind(this);\n    if(typeof window.ethereum!=='undefined'){\n      this.setState({isW3:true});\n    }\n    if(typeof window.ethereum!=='undefined'){\n      window.ethereum.on('accountsChanged', function (accounts) {\n        //window.location.reload();\n\n        if (!ethEnabled()) {\n          alert(\"Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!\");\n        }\n        else{\n          let userDetailObj = {};\n          window.web3.eth.getAccounts().then((accounts)=>{\n            if (accounts.length === 0) {\n              console.log('MetaMask is locked')\n              app.setState({isLogin:false})\n            }\n            else {\n              app.setState({isLogin:true})\n              userDetailObj.account = accounts[0]\n              window.web3.eth.getBalance(accounts[0]).then((value)=>{\n                userDetailObj.balance = window.web3.utils.fromWei(value)\n                app.setState({userDetail:userDetailObj})\n              });\n              userDetailObj.contract = new window.web3.eth.Contract(_ABI, _CONTRACT_ADDRESS)\n              userDetailObj.contract.methods.isUserExists(userDetailObj.account).call().then((result)=>{\n                userDetailObj.userExist = result\n                app.setState({userExist:result})\n              });\n              userDetailObj.contract.methods.users(userDetailObj.account).call().then((result)=>{\n                userDetailObj.itemCount = result.itemCount;\n                app.setState({itemCount:result.itemCount})\n              });\n              userDetailObj.contract.methods.lastItemId().call().then((result)=>{\n                app.setState({universeItemCount:(result)})\n              });\n              userDetailObj.contract.methods.getAllItemsByUser(userDetailObj.account).call().then((result)=>{\n                let itemObj = {};\n                itemObj.idArr = [];\n                itemObj.powerArr = [];\n                itemObj.lastWinArr = [];\n                for(let i=0;i<result[Object.keys(result)[0]].length;i++){\n                  itemObj.idArr[i] = result[Object.keys(result)[0]][i];\n                  itemObj.powerArr[i] = result[Object.keys(result)[1]][i];\n                  itemObj.lastWinArr[i] = window.web3.utils.fromWei(result[Object.keys(result)[2]][i],'ether');\n                }\n                userDetailObj.itemIdArr = itemObj.idArr;\n                userDetailObj.itemPowerArr = itemObj.powerArr;\n                userDetailObj.lastWinArr = itemObj.lastWinArr;\n                app.setState({userDetail:userDetailObj});\n              });\n              userDetailObj.contract.methods.lastItemId().call().then((result)=>{\n                if(result>8){\n                  userDetailObj.winnerArr = [];\n                  userDetailObj.winnerAmountArr = [];\n                  for(let i=0;i<8;i++){\n                    userDetailObj.contract.methods.allItems(i).call().then((result)=>{\n                      userDetailObj.winnerArr[i] = result.owner.substring(0,6)+\"...\";\n                      userDetailObj.winnerAmountArr[i] = window.web3.utils.fromWei(result.LastWinAmount,'ether');\n                      app.setState({userDetail:userDetailObj});\n                    });\n                  }\n                }\n              });\n            }\n          },()=>{\n            console.log(\"fail callback\");\n          })\n        }\n      });\n    }\n  }\n  render() {\n    if(this.state.isLogin){\n      return (\n        <MainPage userDetail={this.state.userDetail} universeItemCount={this.state.universeItemCount}/>\n      );\n    }else {\n      return (\n        <div className=\"container\" style={{display: 'flex', justifyContent: 'center'}}>\n          <Button variant=\"primary\" onClick={this.LoginToMetamask}>Connect to Metamask</Button>\n        </div>\n      );\n    }\n  }\n  LoginToMetamask(){\n    this.loadBlockchainData()\n  }\n}\nconst ethEnabled = () => {\n  if (window.ethereum) {\n    window.web3 = new Web3(window.ethereum);\n    window.ethereum.enable();\n    return true;\n  }\n  return false;\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}