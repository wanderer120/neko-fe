{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/wanderer120/Documents/projects/neko/neko-fe/src/App.js\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport './App.css';\nimport { _ABI, _CONTRACT_ADDRESS } from './config';\nimport Button from 'react-bootstrap/Button';\nimport MainPage from './Components/MainPage';\nvar app;\n\nclass App extends Component {\n  componentWillMount() {\n    this.loadBlockchainData();\n  }\n\n  async loadBlockchainData() {\n    if (!ethEnabled()) {\n      alert(\"Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!\");\n    } else {\n      let userDetailObj = {};\n      const accounts = await window.web3.eth.getAccounts().then(accounts => {\n        if (accounts.length === 0) {\n          console.log('MetaMask is locked');\n          this.setState({\n            isLogin: false\n          });\n        } else {\n          this.setState({\n            isLogin: true\n          });\n          userDetailObj.account = accounts[0];\n          window.web3.eth.getBalance(accounts[0]).then(value => {\n            userDetailObj.balance = window.web3.utils.fromWei(value);\n            this.setState({\n              userDetail: userDetailObj\n            });\n          });\n          userDetailObj.contract = new window.web3.eth.Contract(_ABI, _CONTRACT_ADDRESS);\n          userDetailObj.contract.methods.isUserExists(userDetailObj.account).call().then(result => {\n            userDetailObj.userExist = result;\n            this.setState({\n              userExist: result\n            });\n          });\n          userDetailObj.contract.methods.Users(userDetailObj.account).call().then(result => {\n            userDetailObj.itemCount = result.itemCount;\n            this.setState({\n              itemCount: result.itemCount\n            });\n          });\n          userDetailObj.contract.methods.getAllItemsByUser(userDetailObj.account).call().then(result => {\n            let itemObj = {};\n            itemObj.idArr = [];\n            itemObj.powerArr = [];\n            itemObj.lastWinArr = [];\n\n            for (let i = 0; i < result[Object.keys(result)[0]].length; i++) {\n              itemObj.idArr[i] = result[Object.keys(result)[0]][i];\n              itemObj.powerArr[i] = result[Object.keys(result)[1]][i];\n              itemObj.lastWinArr[i] = window.web3.utils.fromWei(result[Object.keys(result)[2]][i], 'ether');\n            }\n\n            for (let i = 0; i < result[Object.keys(result)[0]].length; i++) {\n              console.log(itemObj.lastWinArr[i]);\n            }\n\n            userDetailObj.itemIdArr = itemObj.idArr;\n            userDetailObj.itemPowerArr = itemObj.powerArr;\n            userDetailObj.lastWinArr = itemObj.lastWinArr;\n            this.setState({\n              userDetail: userDetailObj\n            });\n          });\n          userDetailObj.contract.methods.lastItemId().call().then(result => {\n            this.setState({\n              universeItemCount: result - 1\n            });\n\n            if (result > 8) {\n              userDetailObj.winnerArr = [];\n              userDetailObj.winnerAmountArr = [];\n\n              for (let i = 0; i < 8; i++) {\n                userDetailObj.contract.methods.getWinners().call().then(result => {\n                  userDetailObj.winnerArr[i] = result[Object.keys(result)[0]][i].substring(0, 6) + \"...\";\n                  userDetailObj.winnerAmountArr[i] = result[Object.keys(result)[1]][i];\n                  this.setState({\n                    userDetail: userDetailObj\n                  });\n                });\n              }\n            }\n          });\n        }\n      }, () => {\n        console.log(\"fail callback\");\n      });\n    }\n  }\n\n  constructor(props) {\n    super(props);\n    app = this;\n    this.state = {\n      isLogin: false,\n      userDetail: {\n        account: -1,\n        balance: -1,\n        contract: {}\n      },\n      userExist: false,\n      itemCount: -1,\n      universeItemCount: -1,\n      isW3: false\n    };\n    this.LoginToMetamask = this.LoginToMetamask.bind(this);\n\n    if (typeof window.ethereum !== 'undefined') {\n      this.setState({\n        isW3: true\n      });\n    }\n\n    if (typeof window.ethereum !== 'undefined') {\n      window.ethereum.on('accountsChanged', function (accounts) {\n        //window.location.reload();\n        if (!ethEnabled()) {\n          alert(\"Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!\");\n        } else {\n          let userDetailObj = {};\n          window.web3.eth.getAccounts().then(accounts => {\n            if (accounts.length === 0) {\n              console.log('MetaMask is locked');\n              app.setState({\n                isLogin: false\n              });\n            } else {\n              app.setState({\n                isLogin: true\n              });\n              userDetailObj.account = accounts[0];\n              window.web3.eth.getBalance(accounts[0]).then(value => {\n                userDetailObj.balance = window.web3.utils.fromWei(value);\n                app.setState({\n                  userDetail: userDetailObj\n                });\n              });\n              userDetailObj.contract = new window.web3.eth.Contract(_ABI, _CONTRACT_ADDRESS);\n              userDetailObj.contract.methods.isUserExists(userDetailObj.account).call().then(result => {\n                userDetailObj.userExist = result;\n                app.setState({\n                  userExist: result\n                });\n              });\n              userDetailObj.contract.methods.Users(userDetailObj.account).call().then(result => {\n                userDetailObj.itemCount = result.itemCount;\n                app.setState({\n                  itemCount: result.itemCount\n                });\n              });\n              userDetailObj.contract.methods.getAllItemsByUser(userDetailObj.account).call().then(result => {\n                let itemObj = {};\n                itemObj.idArr = [];\n                itemObj.powerArr = [];\n                itemObj.lastWinArr = [];\n\n                for (let i = 0; i < result[Object.keys(result)[0]].length; i++) {\n                  itemObj.idArr[i] = result[Object.keys(result)[0]][i];\n                  console.log(result[Object.keys(result)[2]][i]);\n                  itemObj.powerArr[i] = result[Object.keys(result)[1]][i];\n                  itemObj.lastWinArr[i] = window.web3.utils.fromWei(result[Object.keys(result)[2]][i], 'ether');\n                }\n\n                userDetailObj.itemIdArr = itemObj.idArr;\n                userDetailObj.itemPowerArr = itemObj.powerArr;\n                userDetailObj.lastWinArr = itemObj.lastWinArr;\n                app.setState({\n                  userDetail: userDetailObj\n                });\n              });\n              userDetailObj.contract.methods.lastItemId().call().then(result => {\n                app.setState({\n                  universeItemCount: result - 1\n                });\n\n                if (result > 8) {\n                  userDetailObj.winnerArr = [];\n                  userDetailObj.winnerAmountArr = [];\n\n                  for (let i = 0; i < 8; i++) {\n                    userDetailObj.contract.methods.getWinners().call().then(result => {\n                      userDetailObj.winnerArr[i] = result[Object.keys(result)[0]][i].substring(0, 6) + \"...\";\n                      userDetailObj.winnerAmountArr[i] = window.web3.utils.fromWei(result[Object.keys(result)[1]][i], 'ether');\n                      app.setState({\n                        userDetail: userDetailObj\n                      });\n                    });\n                  }\n                }\n              });\n            }\n          }, () => {\n            console.log(\"fail callback\");\n          });\n        }\n      });\n    }\n  }\n\n  render() {\n    if (this.state.isLogin) {\n      return /*#__PURE__*/_jsxDEV(MainPage, {\n        userDetail: this.state.userDetail,\n        universeItemCount: this.state.universeItemCount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        style: {\n          display: 'flex',\n          justifyContent: 'center'\n        },\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: this.LoginToMetamask,\n          children: \"Connect to Metamask\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this);\n    }\n  }\n\n  LoginToMetamask() {\n    this.loadBlockchainData();\n  }\n\n}\n\nconst ethEnabled = () => {\n  if (window.ethereum) {\n    window.web3 = new Web3(window.ethereum);\n    window.ethereum.enable();\n    return true;\n  }\n\n  return false;\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/wanderer120/Documents/projects/neko/neko-fe/src/App.js"],"names":["React","Component","Web3","_ABI","_CONTRACT_ADDRESS","Button","MainPage","app","App","componentWillMount","loadBlockchainData","ethEnabled","alert","userDetailObj","accounts","window","web3","eth","getAccounts","then","length","console","log","setState","isLogin","account","getBalance","value","balance","utils","fromWei","userDetail","contract","Contract","methods","isUserExists","call","result","userExist","Users","itemCount","getAllItemsByUser","itemObj","idArr","powerArr","lastWinArr","i","Object","keys","itemIdArr","itemPowerArr","lastItemId","universeItemCount","winnerArr","winnerAmountArr","getWinners","substring","constructor","props","state","isW3","LoginToMetamask","bind","ethereum","on","render","display","justifyContent","enable"],"mappings":"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","sourcesContent":["import 'bootstrap/dist/css/bootstrap.css';\nimport React, { Component } from 'react'\nimport Web3 from 'web3'\nimport './App.css'\n\nimport { _ABI, _CONTRACT_ADDRESS } from './config'\n\nimport Button from 'react-bootstrap/Button'\nimport MainPage from './Components/MainPage'\n\nvar app;\nclass App extends Component {\n  componentWillMount() {\n    this.loadBlockchainData()\n  }\n  async loadBlockchainData() {\n    if (!ethEnabled()) {\n      alert(\"Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!\");\n    }\n    else{\n      let userDetailObj = {};\n      const accounts = await window.web3.eth.getAccounts().then((accounts)=>{\n        if (accounts.length === 0) {\n          console.log('MetaMask is locked')\n          this.setState({isLogin:false})\n        }\n        else {\n          this.setState({isLogin:true})\n          userDetailObj.account = accounts[0]\n          window.web3.eth.getBalance(accounts[0]).then((value)=>{\n            userDetailObj.balance = window.web3.utils.fromWei(value)\n            this.setState({userDetail:userDetailObj})\n          });\n          userDetailObj.contract = new window.web3.eth.Contract(_ABI, _CONTRACT_ADDRESS)\n          userDetailObj.contract.methods.isUserExists(userDetailObj.account).call().then((result)=>{\n            userDetailObj.userExist = result\n            this.setState({userExist:result})\n          });\n          userDetailObj.contract.methods.Users(userDetailObj.account).call().then((result)=>{\n            userDetailObj.itemCount = result.itemCount;\n            this.setState({itemCount:result.itemCount})\n          });\n          userDetailObj.contract.methods.getAllItemsByUser(userDetailObj.account).call().then((result)=>{\n            let itemObj = {};\n            itemObj.idArr = [];\n            itemObj.powerArr = [];\n            itemObj.lastWinArr = [];\n            for(let i=0;i<result[Object.keys(result)[0]].length;i++){\n              itemObj.idArr[i] = result[Object.keys(result)[0]][i];\n              itemObj.powerArr[i] = result[Object.keys(result)[1]][i];\n              itemObj.lastWinArr[i] = window.web3.utils.fromWei(result[Object.keys(result)[2]][i],'ether');\n            }\n            for(let i=0;i<result[Object.keys(result)[0]].length;i++){\n              console.log(itemObj.lastWinArr[i]);\n            }\n            userDetailObj.itemIdArr = itemObj.idArr;\n            userDetailObj.itemPowerArr = itemObj.powerArr;\n            userDetailObj.lastWinArr = itemObj.lastWinArr;\n            this.setState({userDetail:userDetailObj});\n          });\n          userDetailObj.contract.methods.lastItemId().call().then((result)=>{\n            this.setState({universeItemCount:(result-1)})\n            if(result>8){\n              userDetailObj.winnerArr = [];\n              userDetailObj.winnerAmountArr = [];\n              for(let i=0;i<8;i++){\n                userDetailObj.contract.methods.getWinners().call().then((result)=>{\n                  userDetailObj.winnerArr[i] = result[Object.keys(result)[0]][i].substring(0,6)+\"...\";\n                  userDetailObj.winnerAmountArr[i] = result[Object.keys(result)[1]][i];\n                  this.setState({userDetail:userDetailObj});\n                });\n              }\n            }\n          });\n        }\n      },()=>{\n        console.log(\"fail callback\");\n      })\n    }\n  }\n  constructor(props) {\n    super(props)\n    app = this;\n    this.state = {\n      isLogin: false,\n      userDetail: {account:-1,balance:-1,contract:{}},\n      userExist: false,\n      itemCount:-1,\n      universeItemCount:-1,\n      isW3:false\n    }\n    this.LoginToMetamask = this.LoginToMetamask.bind(this);\n    if(typeof window.ethereum!=='undefined'){\n      this.setState({isW3:true});\n    }\n    if(typeof window.ethereum!=='undefined'){\n      window.ethereum.on('accountsChanged', function (accounts) {\n        //window.location.reload();\n\n        if (!ethEnabled()) {\n          alert(\"Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!\");\n        }\n        else{\n          let userDetailObj = {};\n          window.web3.eth.getAccounts().then((accounts)=>{\n            if (accounts.length === 0) {\n              console.log('MetaMask is locked')\n              app.setState({isLogin:false})\n            }\n            else {\n              app.setState({isLogin:true})\n              userDetailObj.account = accounts[0]\n              window.web3.eth.getBalance(accounts[0]).then((value)=>{\n                userDetailObj.balance = window.web3.utils.fromWei(value)\n                app.setState({userDetail:userDetailObj})\n              });\n              userDetailObj.contract = new window.web3.eth.Contract(_ABI, _CONTRACT_ADDRESS)\n              userDetailObj.contract.methods.isUserExists(userDetailObj.account).call().then((result)=>{\n                userDetailObj.userExist = result\n                app.setState({userExist:result})\n              });\n              userDetailObj.contract.methods.Users(userDetailObj.account).call().then((result)=>{\n                userDetailObj.itemCount = result.itemCount;\n                app.setState({itemCount:result.itemCount})\n              });\n              userDetailObj.contract.methods.getAllItemsByUser(userDetailObj.account).call().then((result)=>{\n                let itemObj = {};\n                itemObj.idArr = [];\n                itemObj.powerArr = [];\n                itemObj.lastWinArr = [];\n                for(let i=0;i<result[Object.keys(result)[0]].length;i++){\n                  itemObj.idArr[i] = result[Object.keys(result)[0]][i];\n                  console.log(result[Object.keys(result)[2]][i]);\n                  itemObj.powerArr[i] = result[Object.keys(result)[1]][i];\n                  itemObj.lastWinArr[i] = window.web3.utils.fromWei(result[Object.keys(result)[2]][i],'ether');\n                }\n                userDetailObj.itemIdArr = itemObj.idArr;\n                userDetailObj.itemPowerArr = itemObj.powerArr;\n                userDetailObj.lastWinArr = itemObj.lastWinArr;\n                app.setState({userDetail:userDetailObj});\n              });\n              userDetailObj.contract.methods.lastItemId().call().then((result)=>{\n                app.setState({universeItemCount:(result-1)})\n                if(result>8){\n                  userDetailObj.winnerArr = [];\n                  userDetailObj.winnerAmountArr = [];\n                  for(let i=0;i<8;i++){\n                    userDetailObj.contract.methods.getWinners().call().then((result)=>{\n                      userDetailObj.winnerArr[i] = result[Object.keys(result)[0]][i].substring(0,6)+\"...\";\n                      userDetailObj.winnerAmountArr[i] = window.web3.utils.fromWei(result[Object.keys(result)[1]][i],'ether');\n                      app.setState({userDetail:userDetailObj});\n                    });\n                  }\n                }\n              });\n            }\n          },()=>{\n            console.log(\"fail callback\");\n          })\n        }\n      });\n    }\n  }\n  render() {\n    if(this.state.isLogin){\n      return (\n        <MainPage userDetail={this.state.userDetail} universeItemCount={this.state.universeItemCount}/>\n      );\n    }else {\n      return (\n        <div className=\"container\" style={{display: 'flex', justifyContent: 'center'}}>\n          <Button variant=\"primary\" onClick={this.LoginToMetamask}>Connect to Metamask</Button>\n        </div>\n      );\n    }\n  }\n  LoginToMetamask(){\n    this.loadBlockchainData()\n  }\n}\nconst ethEnabled = () => {\n  if (window.ethereum) {\n    window.web3 = new Web3(window.ethereum);\n    window.ethereum.enable();\n    return true;\n  }\n  return false;\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}